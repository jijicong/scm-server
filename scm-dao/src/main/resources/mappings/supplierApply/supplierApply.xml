<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.trc.mapper.supplier.ISupplierApplyMapper">
    <resultMap id="supplierApplyMap" type="org.trc.domain.supplier.SupplierApply">
        <result property="id" column="id"/>
        <result property="applyCode" column="apply_code"/>
        <result property="supplierId" column="supplier_id"/>
        <result property="channelId" column="channel_id"/>
        <result property="supplierCode" column="supplier_code"/>
        <result property="channelCode" column="channel_code"/>
        <result property="description" column="description"/>
        <result property="status" column="status"/>
        <result property="isDeleted" column="is_deleted"/>
        <result property="auditOpinion" column="audit_opinion"/>
        <result property="createOperator" column="create_operator"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
        <result property="contact" column="contact"/>
        <result property="supplierName" column="supplier_name"/>
        <result property="supplierKindCode" column="supplier_kind_code"/>
    </resultMap>

    <sql id="supplierApplyColumns">
          a.id,a.apply_code,a.supplier_id,a.channel_id,a.supplier_code,a.channel_code,
          a.description,a.status,a.is_deleted,a.audit_opinion,a.create_operator,a.create_time,a.update_time,b.contact,b.supplier_name,b.supplier_kind_code
    </sql>

    <sql id="supplierApplyJoins">
        LEFT JOIN supplier b ON a.supplier_id=b.id
    </sql>

    <select id="querySupplierApplyList" resultMap="supplierApplyMap" parameterType="java.util.Map">
        SELECT
        <include refid="supplierApplyColumns"/>
        FROM apply_for_supplier a
        <include refid="supplierApplyJoins"/>
        <where>
            <if test="supplierName != null and supplierName != ''">
                AND b.supplier_name = #{supplierName}
            </if>
            <if test="supplierCode != null and supplierCode != ''">
                AND b.supplier_code = #{supplierCode}
            </if>
            <if test="contact != null and contact != ''">
                AND b.contact = #{contact}
            </if>
            <if test="status != null and status != ''">
                AND b.status = #{status}
            </if>
            <if test="startTime != null and startTime != ''">
                AND b.create_time > #{startTime}
            </if>
            <if test="endTime != null and endTime != ''">
                AND b.create_time &lt; #{endTime}
            </if>
        </where>
    </select>

    <select id="queryCountSupplierApply" resultType="java.lang.Integer" parameterType="java.util.Map">
        SELECT COUNT(0)
        FROM apply_for_supplier a
        <include refid="supplierApplyJoins"/>
        <where>
            <if test="supplierName != null and supplierName != ''">
                AND b.supplier_name = #{supplierName}
            </if>
            <if test="supplierCode != null and supplierCode != ''">
                AND b.supplier_code = #{supplierCode}
            </if>
            <if test="contact != null and contact != ''">
                AND b.contact = #{contact}
            </if>
            <if test="status != null and status != ''">
                AND b.status = #{status}
            </if>
            <if test="startTime != null and startTime != ''">
                AND b.create_time > #{startTime}
            </if>
            <if test="endTime != null and endTime != ''">
                AND b.create_time &lt; #{endTime}
            </if>
        </where>
    </select>
</mapper>